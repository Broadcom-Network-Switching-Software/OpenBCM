config show; attach; version
    phy_chain_rx_polarity_flip_physical{16.0}=1
    phy_chain_tx_lane_map_physical{49.0}=0x2130
    phy_chain_rx_polarity_flip_physical{59.0}=1
    phy_chain_rx_polarity_flip_physical{68.0}=1
    portmap_9=9:100
    phy_chain_rx_lane_map_physical{21.0}=0x1302
    riot_overlay_ecmp_resilient_hash_size=16384
    phy_chain_rx_lane_map_physical{29.0}=0x1302
    phy_chain_rx_polarity_flip_physical{34.0}=1
    phy_chain_tx_polarity_flip_physical{52.0}=1
    phy_chain_rx_lane_map_physical{5.0}=0x1302
    phy_chain_tx_lane_map_physical{33.0}=0x0312
    phy_chain_tx_polarity_flip_physical{61.0}=1
    pp_clock_frequency=833
    phy_chain_tx_polarity_flip_physical{35.0}=1
    phy_chain_tx_lane_map_physical{1.0}=0x0213
    phy_chain_rx_polarity_flip_physical{2.0}=0
    phy_chain_tx_lane_map_physical{9.0}=0x0213
    phy_chain_rx_lane_map_physical{13.0}=0x1302
    phy_chain_tx_polarity_flip_physical{44.0}=1
    portmap_21=21:25
    portmap_13=13:100
    phy_chain_tx_lane_map_physical{25.0}=0x0312
    phy_chain_tx_polarity_flip_physical{10.0}=0
    phy_chain_rx_lane_map_physical{65.0}=0x0213
    phy_chain_tx_polarity_flip_physical{53.0}=1
    portmap_30=30:25
    portmap_22=22:25
    oversubscribe_mode=2
    phy_chain_rx_polarity_flip_physical{44.0}=1
    phy_chain_tx_polarity_flip_physical{62.0}=1
    phy_chain_tx_polarity_flip_physical{27.0}=1
    portmap_31=31:25
    portmap_23=23:25
    phy_chain_rx_polarity_flip_physical{18.0}=0
    phy_chain_rx_polarity_flip_physical{3.0}=1
    portmap_40=40:25
    portmap_32=32:25
    portmap_24=24:25
    phy_chain_tx_lane_map_physical{17.0}=0x0213
    phy_chain_rx_lane_map_physical{57.0}=0x0312
    l3_ecmp_levels=1
    phy_chain_rx_polarity_flip_physical{27.0}=1
    phy_chain_tx_polarity_flip_physical{45.0}=1
    portmap_41=41:25
    portmap_33=33:25
    portmap_25=25:25
    portmap_17=17:100
    phy_chain_tx_lane_map_physical{61.0}=0x1032
    phy_chain_tx_polarity_flip_physical{11.0}=0
    phy_chain_rx_polarity_flip_physical{36.0}=1
    phy_chain_tx_polarity_flip_physical{54.0}=1
    portmap_50=50:25
    portmap_42=42:25
    portmap_34=34:25
    portmap_26=26:25
    management_port_mode=0
    riot_overlay_l3_egress_mem_size=8192
    phy_chain_tx_polarity_flip_physical{63.0}=1
    portmap_51=51:25
    phy_chain_rx_lane_map_physical{41.0}=0x1203
    portmap_43=43:25
    portmap_35=35:25
    portmap_27=27:25
    phy_chain_rx_polarity_flip_physical{11.0}=1
    phy_chain_rx_lane_map_physical{49.0}=0x0312
    phy_chain_rx_polarity_flip_physical{19.0}=1
    phy_chain_tx_polarity_flip_physical{37.0}=1
    portmap_60=60:25
    portmap_52=52:25
    portmap_44=44:25
    portmap_36=36:25
    portmap_28=28:25
    phy_chain_tx_lane_map_physical{53.0}=0x1032
    phy_chain_rx_polarity_flip_physical{63.0}=1
    phy_chain_tx_polarity_flip_physical{46.0}=1
    portmap_61=61:25
    portmap_53=53:25
    portmap_45=45:25
    portmap_37=37:25
    portmap_29=29:25
    phy_chain_tx_polarity_flip_physical{12.0}=0
    phy_chain_rx_polarity_flip_physical{37.0}=1
    phy_chain_tx_polarity_flip_physical{55.0}=1
    fpem_mem_entries=32768
    phy_chain_rx_lane_map_physical{33.0}=0x3102
    portmap_62=62:25
    pbmp_xport_xe=0x1fffffffffffe22226
    portmap_54=54:25
    portmap_46=46:25
    portmap_38=38:25
    l2_mem_entries=32768
    os=unix
    portmap_63=63:25
    portmap_55=55:25
    portmap_47=47:25
    portmap_39=39:25
    bcm_tdm_frequency=1252
    phy_chain_tx_lane_map_physical{45.0}=0x1032
    phy_chain_rx_polarity_flip_physical{55.0}=1
    phy_chain_tx_polarity_flip_physical{38.0}=1
    portmap_64=64:25
    portmap_56=56:25
    portmap_48=48:25
    l3_alpm_enable=1
    phy_chain_rx_polarity_flip_physical{64.0}=1
    phy_chain_tx_polarity_flip_physical{47.0}=1
    phy_chain_rx_lane_map_physical{25.0}=0x3021
    portmap_65=65:25
    portmap_57=57:25
    portmap_49=49:25
    phy_chain_rx_lane_map_physical{1.0}=0x3021
    phy_chain_rx_polarity_flip_physical{38.0}=1
    phy_chaine_map_physical{61.0}=0x2031
    phy_chain_rx_polarity_flip_physical{31.0}=1
    core_clock_frequency=1252
    phy_chain_tx_lane_map_physical{29.0}=0x3210
    port_oversubscribe{2}=0
    phy_chain_rx_polarity_flip_physical{48.0}=1
    phy_chain_tx_polarity_flip_physical{66.0}=1
    phy_chain_tx_polarity_flip_physical{32.0}=1
    port_oversubscribe{3}=0
    phy_chain_rx_polarity_flip_physical{7.0}=1
    phy_chain_tx_polarity_flip_physical{8.0}=1
    phy_chain_tx_lane_map_physical{13.0}=0x3210
    phy_chain_rx_lane_map_physical{53.0}=0x2031
    phy_chain_rx_polarity_flip_physical{23.0}=1
    portmap_1=1:25:m
    phy_chain_rx_polarity_flip_physical{32.0}=1
    phy_chain_tx_lane_map_physical{65.0}=0x2130
    phy_chain_tx_polarity_flip_physical{50.0}=1
    flow_init_mode=1
    portmap_2=2:25:m
    phy_chain_tx_polarity_flip_physical{58.0}=1
    port_oversubscribe{4}=0
    phy_chain_rx_polarity_flip_physical{41.0}=1
    max_vp_lags=0
    phy_chain_tx_polarity_flip_physical{24.0}=1
    phy_chain_rx_lane_map_physical{45.0}=0x2031
    phy_chain_rx_polarity_flip_physical{15.0}=1
    phy_chain_tx_polarity_flip_physical{33.0}=1
    pbmp_oversubscribe=0x1fffffffffffe22220
    l3_mem_entries=32768
    phy_chain_rx_polarity_flip_physical{8.0}=1
    phy_chain_rx_polarity_flip_physical{24.0}=1
    phy_chain_tx_lane_map_physical{57.0}=0x2130
    phy_chain_tx_polarity_flip_physical{42.0}=1
    portmap_5=5:100
    phy_chain_rx_polarity_flip_physical{33.0}=1
    phy_chain_tx_polarity_flip_physical{16.0}=1
    phy_chain_rx_lane_map_physical{37.0}=0x3102
    phy_chain_rx_polarity_flip_physical{42.0}=1
    phy_chain_tx_polarity_flip_physical{60.0}=1
    phy_chain_tx_polarity_flip_physical{25.0}=1
    phy_chain_tx_lane_map_physical{41.0}=0x2130
    phy_chain_rx_polarity_flip_physical{51.0}=1
Attach: Unit 0 (BCM56470_A0): attached (current unit)
Broadcom Command Monitor: Copyright (c) 1998-2020 Broadcom
Release: sdk-6.5.20 built 20200416 (Thu Apr 16 08:06:05 2020)
From sdkrel@lc-sj1-3768:/projects/ntsw_sw14_scratch/sdkrel/regress/sdk-master/src/sdk.dpart.56470
Platform: SLK_BCM957812
OS: Unix (Posix)
Chips:
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
       BCM56470_A0,
      
PHYs:  BCM5218, BCM5220/21, BCM5226, BCM5228,
    BCM5238, BCM5248, BCM5400, BCM5401,
    BCM5402, BCM5404, BCM5424/34, BCM5411,
    BCM5461, BCM5464, BCM5466, BCM5478,
    BCM5488, BCM54980, BCM54980, BCM54980,
    BCM54980, BCM53314, BCM5482/801x, BCM54684,
    BCM54640, BCM54682E, BCM54684E, BCM54685,
    BCM54616, BCM54618E, BCM54618SE, BCM84707,
    BCM84073, BCM84074, BCM84728, BCM84748,
    BCM84727, BCM84747, BCM84762, BCM84764,
    BCM84042, BCM84044, BCM8806X, BCM54182,
    BCM54185, BCM54180, BCM54140, BCM54192,
    BCM54195, BCM54190, BCM54194, BCM54210,
    BCM54220, BCM54280, BCM54282, BCM54240,
    BCM54285, BCM5428X, BCM54290, BCM54292,
    BCM54294, BCM54295, BCM54296, BCM5421S
    BCM54680, BCM53324, BCM56160-GPHY, BCM53540-GPHY,
    BCM56275-GPHY, BCM54880, BCM54881, BCM54810,
    BCM54811, BCM54640E, BCM54880E, BCM54680E,
    BCM52681E, BCM8703, BCM8704, BCM8705/24/25,
    BCM8706/8726, BCM8727, BCM8728/8747, BCM8072,
    BCM8073, BCM8074, BCM8040, BCM8481X,
    BCM84812, BCM84821, BCM84822, BCM84823,
    BCM84833, BCM84834, BCM84835, BCM84836,
    BCM84844, BCM84846, BCM84848, BCM84858,
    BCM84856, BCM84860, BCM84861, BCM84864,
    BCM84868, BCM84888, BCM84884, BCM84888E,
    BCM84884E, BCM84881, BCM84880, BCM84888S,
    BCM84887, BCM84886, BCM84885, BCM8750,
    BCM8752, BCM8754, BCM84740, BCM84164,
    BCM84758, BCM84780, BCM84784, BCM84318,
    BCM84328, BCM84793, BCM82328, Furia
    Huracan, Sesto, Madura, BCM82780,
    copper sfp
   
~~~ #1) test_setup(): ** start **
ingress_port_multi_setup port: 1
egress_port_multi_setup port: 2
~~~ #1) test_setup(): ** end **
~~~ #2) config_vxlan_ipv4_vtep(): ** start **
Configure Vxlan global configuration
Get flow handler for CLASSIC_VXLAN

Setup access VP on port 1
Configure Vxlan access port configuration
Access: create VPN
create multicast group for UUC/MC/BC
Access: create flow port vp
Access: flow port=0xb0000001
Access: create UL L3 interface
Access: set encapsulation. VP=>egress-obj{Device,Port}
Access: create OL L3 interface
Access: create OL L3 egress object
Access: create L3 ingress interface
Access: update the vrf field in VFI table
Access: add flow match (match: port,vlan criteria)
Access: l2 station entry add
Access: add the l3 route

Setup network VP on port 2
Configure Vxlan network port configuration
Network: create VPN
create multicast group for UUC/MC/BC
Network: create flow port vp
Network: flow port=0xb0000002
Network: create UL L3 interface
Network: create UL L3 egress object
Network: encap add, VFI-->VNID
Network: set encapsulation. VP=>egress-obj{Device,Port}
Network: create OL L3 interface
Network: create OL L3 egress object
Network: create L3 ingress interface
Network: update the vrf field in VFI table
Network: set egress vlan_xlate key_type for network VP
Network: configure match condition to derive VPN (Match:{VN_ID},Derive: VFI (VPN))
Network: add flow match (match: SIP => network SVP)
Network: underlay l2 station entry add
Network: overlay l2 station entry add
Network: add the l3 route
Tunnel_init: create flow tunnel initiator
Tunnel_term: create flow tunnel terminator
~~~ #2) config_vxlan_ipv4_vtep(): ** end **
~~~ #3) verify(): ** start **
Current header mode for unit 0 is now Ieee (0).
vlan 1	ports cpu,ce,xe (0x00000000000000000000000000000000000000000000001fffffffffffe22227), untagged ce,xe (0x00000000000000000000000000000000000000000000001fffffffffffe22226) MCAST_FLOOD_UNKNOWN
vlan 10	ports xe0 (0x0000000000000000000000000000000000000000000000000000000000000002), untagged none (0x0000000000000000000000000000000000000000000000000000000000000000) MCAST_FLOOD_UNKNOWN
vlan 11	ports xe1 (0x0000000000000000000000000000000000000000000000000000000000000004), untagged none (0x0000000000000000000000000000000000000000000000000000000000000000) MCAST_FLOOD_UNKNOWN
Unit 0, Total Number of DEFIP entries: 12288
#     VRF     Net addr             Next Hop Mac        INTF MODID PORT PRIO CLASS HIT VLAN
3072  10       192.168.10.0/24      00:00:00:00:00:00 700002    0     0     0    0 n
3072  10       192.168.20.0/24      00:00:00:00:00:00 700003    0     0     0    0 n
Entry  Mac                 Vlan INTF PORT MOD MPLS_LABEL ToCpu Drop RefCount L3MC
700002  00:00:00:11:11:11    0    1     1    0        -1   no   no    1   no
700003  00:00:00:02:02:02    0    2     2    0        -1   no   no    1   no
108193  00:00:00:00:aa:aa   11 4096     2    0        -1   no   no    1   no
Free L3INTF entries: 16379
Unit  Intf  VRF Group VLAN    Source Mac     MTU TTL Tunnel InnerVlan  NATRealm
------------------------------------------------------------------
0     1     10    0     28673 00:00:00:22:22:22  16383 0    0     0     0    
0     2     10    0     28674 00:00:00:01:01:01  16383 0    0     0     0    
0     4096  -3    0     11   00:00:00:00:bb:bb  16383 0    0     0     0    

Sending known unicast packet to ingress access side:1
Packet from data=<>, length=72
[bcmPW.0]
[bcmPW.0]Packet[1]: data[0000]: {000000222222} {000000111111} 8100 000a
[bcmPW.0]Packet[1]: data[0010]: 0800 4500 002e 0000 0000 40ff da7e c0a8 
[bcmPW.0]Packet[1]: data[0020]: 0a01 c0a8 1401 0000 0000 0000 0000 0000 
[bcmPW.0]Packet[1]: data[0030]: 0000 0000 0000 0000 0000 0000 0000 0000 
[bcmPW.0]Packet[1]: data[0040]: 0000 0000 49e4 680f 
[bcmPW.0]Packet[1]: length 72 (72). rx-port 1. cos 0. prio_int 0. vlan 28673. reason 0x1. Outer tagged.
[bcmPW.0]Packet[1]: dest-gport -1342177278. src-gport -1342177279. opcode 1.  matched 0. classification-tag 0.
[bcmPW.0]Packet[1]: reasons: FilterMatch
[bcmPW.0]Packet[1]: 
Packet[1]:   Ethernet: dst<00:00:00:22:22:22> src<00:00:00:11:11:11> Tagged Packet ProtID<0x8100> Ctrl<0x000a> Internet Protocol (IP)
Packet[1]:   IP: V(4) src<192.168.10.1> dst<192.168.20.1> hl<5> service-type<0> tl<46> id<0> frg-off<0> ttl<64> > chk-sum<0xda7e>
[bcmPW.0]
[bcmPW.0]Packet[2]: data[0000]: {00000000aaaa} {00000000bbbb} 8100 000b
[bcmPW.0]Packet[2]: data[0010]: 0800 4500 0068 0000 0000 3f11 3f66 0a0a 
[bcmPW.0]Packet[2]: data[0020]: 0a01 1414 1401 ffff 2118 0054 0000 0000 
[bcmPW.0]Packet[2]: data[0030]: 0000 0123 4500 0000 0002 0202 0000 0001 
[bcmPW.0]Packet[2]: data[0040]: 0101 8100 000c 0800 4500 002e 0000 0000 
[bcmPW.0]Packet[2]: data[0050]: 3fff db7e c0a8 0a01 c0a8 1401 0000 0000 
[bcmPW.0]Packet[2]: data[0060]: 0000 0000 0000 0000 0000 0000 0000 0000 
[bcmPW.0]Packet[2]: data[0070]: 0000 0000 0000 0000 0000 69ed 6d6c 
[bcmPW.0]Packet[2]: length 126 (126). rx-port 2. cos 0. prio_int 0. vlan 11. reason 0x1. Outer tagged.
[bcmPW.0]Packet[2]: dest-port 0. dest-mod 0. src-port 2. src-mod 0. opcode 0.  matched 0. classification-tag 0.
[bcmPW.0]Packet[2]: reasons: FilterMatch
[bcmPW.0]Packet[2]: 
Packet[2]:   Ethernet: dst<00:00:00:00:aa:aa> src<00:00:00:00:bb:bb> Tagged Packet ProtID<0x8100> Ctrl<0x000b> Internet Protocol (IP)
Packet[2]:   IP: V(4) src<10.10.10.1> dst<20.20.20.1> hl<5> service-type<0> tl<104> id<0> frg-off<0> ttl<63> > chk-sum<0x3f66>
MC_PERQ_PKT(0).cpu0	    :			  2		     +2 	      2/s
MC_PERQ_BYTE(0).cpu0	    :			198		   +198 	    176/s
RIPC4_64.xe0		    :			  1		     +1 	      1/s
RUC_64.xe0		    :			  1		     +1 	      1/s
ING_NIV_RX_FRAMES_VL.xe0    :			  1		     +1 	      1/s
R127.xe0		    :			  1		     +1 	      1/s
RPKT.xe0		    :			  1		     +1 	      1/s
RUCA.xe0		    :			  1		     +1 	      1/s
RPRM.xe0		    :			  1		     +1 	      1/s
RVLN.xe0		    :			  1		     +1 	      1/s
RPOK.xe0		    :			  1		     +1 	      1/s
RBYT.xe0		    :			 72		    +72 	     64/s
T127.xe0		    :			  1		     +1 	      1/s
TPOK.xe0		    :			  1		     +1 	      1/s
TPKT.xe0		    :			  1		     +1 	      1/s
TUCA.xe0		    :			  1		     +1 	      1/s
TVLN.xe0		    :			  1		     +1 	      1/s
TBYT.xe0		    :			 72		    +72 	     64/s
RPROG0.xe0		    :			  1		     +1 	      1/s
UC_PERQ_PKT(0).xe0	    :			  1		     +1 	      1/s
UC_PERQ_BYTE(0).xe0	    :			 72		    +72 	     64/s
RUC_64.xe1		    :			  1		     +1 	      1/s
ING_NIV_RX_FRAMES_VL.xe1    :			  1		     +1 	      1/s
TDBGC4_64.xe1		    :			  1		     +1 	      1/s
R127.xe1		    :			  1		     +1 	      1/s
RPKT.xe1		    :			  1		     +1 	      1/s
RUCA.xe1		    :			  1		     +1 	      1/s
RPRM.xe1		    :			  1		     +1 	      1/s
RVLN.xe1		    :			  1		     +1 	      1/s
RPOK.xe1		    :			  1		     +1 	      1/s
RBYT.xe1		    :			126		   +126 	    112/s
T127.xe1		    :			  1		     +1 	      1/s
TPOK.xe1		    :			  1		     +1 	      1/s
TPKT.xe1		    :			  1		     +1 	      1/s
TUCA.xe1		    :			  1		     +1 	      1/s
TVLN.xe1		    :			  1		     +1 	      1/s
TBYT.xe1		    :			126		   +126 	    112/s
RPROG3.xe1		    :			  1		     +1 	      1/s
UC_PERQ_PKT(0).xe1	    :			  1		     +1 	      1/s
UC_PERQ_BYTE(0).xe1	    :			126		   +126 	    112/s

verify l2 learning:
mac=00:00:00:11:11:11 vlan=28673 GPORT=0xb0000001 port=0xb0000001(flow) Hit

verify l3 route hit
Unit 0, Total Number of DEFIP entries: 12288
#     VRF     Net addr             Next Hop Mac        INTF MODID PORT PRIO CLASS HIT VLAN
3072  10       192.168.10.0/24      00:00:00:00:00:00 700002    0     0     0    0 n
3072  10       192.168.20.0/24      00:00:00:00:00:00 700003    0     0     0    0 n

 Vpn :28673 

 VpnInfo : 
bcm_flow_vpn_config_t $$ = {
    unsigned int flags = 2 (0x2)
    int broadcast_group = 251658241 (0xf000001)
    int unknown_unicast_group = 251658241 (0xf000001)
    int unknown_multicast_group = 251658241 (0xf000001)
    bcm_vlan_protocol_packet_ctrl_t protocol_pkt = {
        int mmrp_action = 0 (0x0)
        int srp_action = 0 (0x0)
        int arp_reply_action = 0 (0x0)
        int arp_request_action = 0 (0x0)
        int nd_action = 0 (0x0)
        int dhcp_action = 0 (0x0)
        int igmp_report_leave_action = 2 (0x2)
        int igmp_query_action = 2 (0x2)
        int igmp_unknown_msg_action = 2 (0x2)
        int mld_report_done_action = 2 (0x2)
        int mld_query_action = 2 (0x2)
        int ip4_rsvd_mc_action = 2 (0x2)
        int ip6_rsvd_mc_action = 2 (0x2)
        int ip4_mc_router_adv_action = 2 (0x2)
        int ip6_mc_router_adv_action = 2 (0x2)
        int flood_action_according_to_pfm = 0 (0x0)
    }
    int match_port_class = 0 (0x0)
}

 Flow Ports 1
bcm_flow_port_t $$ = {
    int flow_port_id = -1342177279 (0xb0000001)
    unsigned int flags = 16 (0x10)
    unsigned int if_class = 0 (0x0)
    int network_group_id = 0 (0x0)
    unsigned short egress_service_tpid = 33024 (0x8100)
    int dscp_map_id = 0 (0x0)
    int vlan_pri_map_id = 0 (0x0)
    bcm_flow_port_split_horizon_drop_t drop_mode = bcmFlowPortSplitHorizonDropAll (0)
    int ingress_opaque_ctrl_id = 0 (0x0)
}

 Vpn :28674 

 VpnInfo : 
bcm_flow_vpn_config_t $$ = {
    unsigned int flags = 2 (0x2)
    int broadcast_group = 251658242 (0xf000002)
    int unknown_unicast_group = 251658242 (0xf000002)
    int unknown_multicast_group = 251658242 (0xf000002)
    bcm_vlan_protocol_packet_ctrl_t protocol_pkt = {
        int mmrp_action = 0 (0x0)
        int srp_action = 0 (0x0)
        int arp_reply_action = 0 (0x0)
        int arp_request_action = 0 (0x0)
        int nd_action = 0 (0x0)
        int dhcp_action = 0 (0x0)
        int igmp_report_leave_action = 2 (0x2)
        int igmp_query_action = 2 (0x2)
        int igmp_unknown_msg_action = 2 (0x2)
        int mld_report_done_action = 2 (0x2)
        int mld_query_action = 2 (0x2)
        int ip4_rsvd_mc_action = 2 (0x2)
        int ip6_rsvd_mc_action = 2 (0x2)
        int ip4_mc_router_adv_action = 2 (0x2)
        int ip6_mc_router_adv_action = 2 (0x2)
        int flood_action_according_to_pfm = 0 (0x0)
    }
    int match_port_class = 0 (0x0)
}

 Flow Ports 1
bcm_flow_port_t $$ = {
    int flow_port_id = -1342177278 (0xb0000002)
    unsigned int flags = 18 (0x12)
    unsigned int if_class = 0 (0x0)
    int network_group_id = 1 (0x1)
    unsigned short egress_service_tpid = 33024 (0x8100)
    int dscp_map_id = 0 (0x0)
    int vlan_pri_map_id = 0 (0x0)
    bcm_flow_port_split_horizon_drop_t drop_mode = bcmFlowPortSplitHorizonDropAll (0)
    int ingress_opaque_ctrl_id = 0 (0x0)
}
~~~ #3) verify(): ** end **
